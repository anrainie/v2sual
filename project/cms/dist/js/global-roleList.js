(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["global-roleList"],{"4fb3":function(e,t,o){"use strict";var i=o("9229"),r=o.n(i);r.a},9229:function(e,t,o){},ddc4:function(e,t,o){"use strict";(function(e){o("ac6a"),o("456d"),o("7f7f"),o("4ec3");t["a"]={data:function(){return{searchForm:{roleId:"",roleName:"",createUser:""},checkedMenu:[],isSingle:!0,isDubble:!0,roleList:[],totalRole:0,rolePage:1,pageSize:10,listLoading:!1,selectedRoleList:[],editRoleVisible:!1,editLoading:!1,editFormRules:{name:[{required:!0,message:"请输入角色名",trigger:"blur"}],remark:[{required:!0,message:"请输入备注",trigger:"blur"}]},editForm:{name:"",remark:""},addRoleVisible:!1,addLoading:!1,addFormRules:{name:[{required:!0,message:"请输入角色名",trigger:"blur"}],remark:[{required:!0,message:"请输入备注",trigger:"blur"}]},addForm:{name:"",remark:""},levelModalVisible:!1,roleMenuTree:[],defaultProps:{children:"children",label:"name"},checekdTreeNodes:[]}},props:{params:String},methods:{getPageRole:function(e){this.rolePage=e,this.getRoleList()},searchRoleList:function(){this.rolePage=1,this.getRoleList()},getRoleList:function(){var t=this;this.listLoading=!0,this.$get("".concat(e.$axios.server,"/springmvc/role/listAllRoles"),{createUser:this.searchForm.createUser,roleName:this.searchForm.roleName,roleId:this.searchForm.roleId,pageNum:this.rolePage,pageSize:this.pageSize}).then(function(e){var o=e&&e.content&&e.content.data&&e.content.data.roleList||[];if(t.totalRole=e&&e.content&&e.content.data&&e.content.data.totle||0,e.status&&o){for(var i=0;i<o.length;i++)o[i].createTime=t.formatTime(o[i].createTime);t.roleList=o}}),this.listLoading=!1},resetForm:function(){this.searchForm.roleId="",this.searchForm.roleName="",this.searchForm.createUser="",this.rolePage=1,this.getRoleList()},delRole:function(){for(var t=this,o=[],i=this,r=0;r<this.selectedRoleList.length;r++)o.push(this.selectedRoleList[r].roleId);this.$confirm("确认删除该角色吗?","删除角色",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$deleteAxios("".concat(e.$axios.server,"/springmvc/role/deleteRole"),{roleIds:o.join()}).then(function(e){e.status?(i.$notify({title:"删除角色成功",type:"success"}),i.resetForm()):this.$notify({title:e.errorMsg,type:"success"})}).catch(function(e){i.$notify({title:e,type:"error"})})})},showEditRoleModal:function(){this.editRoleVisible=!0,this.editForm.name=this.selectedRoleList[0].roleName,this.editForm.remark=this.selectedRoleList[0].remark},surEditRole:function(){var t=this;this.$refs.editForm.validate(function(o){if(o){t.addLoading=!0;var i={};i.roleId=t.selectedRoleList[0].roleId,i.roleName=t.editForm.name,i.remark=t.editForm.remark,t.$putAxios("".concat(e.$axios.server,"/springmvc/role/editRole"),i).then(function(e){t.addLoading=!1,e.status?(t.$notify({title:"修改角色成功",type:"success"}),t.editRoleVisible=!1,t.getRoleList()):t.$notify({title:"修改角色失败",type:"error"})})}})},surAddRole:function(){var t=this,o=this;this.$refs.addForm.validate(function(i){if(i){t.addLoading=!0;var r={};r.roleName=t.addForm.name,r.remark=t.addForm.remark,t.$post("".concat(e.$axios.server,"/springmvc/role/addRole"),r).then(function(e){o.addLoading=!1,e.status?(t.$notify({title:"创建角色成功",type:"success"}),t.$refs["addForm"].resetFields(),t.addRoleVisible=!1,t.resetForm()):t.$notify({title:"创建角色失败",message:e.errorMsg,type:"error"})})}})},selectRole:function(e){this.selectedRoleList=e||{},e.length>1?(this.isDubble=!1,this.isSingle=!0):1===e.length?(this.isDubble=!1,this.isSingle=!1):(this.isDubble=!0,this.isSingle=!0)},getRoleMenu:function(){var t=this,o=[],i={},r={},l=[];t.checekdTreeNodes=[],t.checkedMenu=[],this.$get("".concat(e.$axios.server,"/springmvc/role/listAllMenus.do"),{roleId:t.selectedRoleList[0].roleId}).then(function(e){e.status&&(l=e&&e.content&&e.content.treeDatas||[],l.length&&(o=l.map(function(e,o){return e.pId&&(r[e.pId]=1),e.id=e.id?e.id:e.accCode?e.pId+e.accCode:e.pId+o,e.pid=e.pId,"true"===e.checked&&e.accCode&&(t.checekdTreeNodes.push(e),t.checkedMenu.push(e.id)),e}),o.map(function(e){!e.pid&&(e.pid="");var t=i[e.pid];t?(!t.children&&(t.children=[]),t.disabled=!0):t=i[e.pid]={id:e.pid,disabled:!0,children:[]};var o=i[e.id]||{id:e.id};o.name=e.name,o.pid=e.pid,o.checked=e.checked,e.accCode&&(o.accCode=e.accCode),o.type=e.type,e.open&&(o.open=e.open),i[e.id]=o,t.children.push(o)}),Object.keys(i).filter(function(e){return!i[e].children}).map(function(e){return delete i[e]}),t.roleMenuTree=i[""].children))})},selectedMenuTree:function(e,t,o){var i=this.checekdTreeNodes,r=!0;if(e.accCode)if(t){for(var l=0;l<i.length;l++){var a=i[l];a.pid===e.pid&&(this.checekdTreeNodes.splice(l,1,e),this.$refs.roleMenuTree.setCheckedNodes(this.checekdTreeNodes),r=!1)}r&&(this.checekdTreeNodes=this.$refs.roleMenuTree.getCheckedNodes())}else this.checekdTreeNodes=this.$refs.roleMenuTree.getCheckedNodes()},showLevelModal:function(){this.getRoleMenu(),this.levelModalVisible=!0},associateLevel:function(){for(var t=this,o=this.$refs.roleMenuTree.getCheckedNodes(),i=this.$refs.roleMenuTree.getHalfCheckedNodes(),r=[],l={},a=0;a<o.length;a++){var s=o[a],n=s.pid+"="+s.accCode;l[s.pid]=1,r.push(n)}for(var d=0;d<i.length;d++){s=i[d],n=s.id+"=PARENT_NODE";l[s.id]||r.push(n)}this.$putAxios("".concat(e.$axios.server,"/springmvc/role/relevanceAccess"),{roleId:this.selectedRoleList[0].roleId,accessIds:r.join()}).then(function(e){e.status?(t.$notify({title:"关联权限成功",type:"success"}),t.levelModalVisible=!1):t.$notify({title:"关联权限失败",message:e.errorMsg,type:"error"})})},formatTime:function(e){var t=e&&new Date(e);return e&&t?t.getFullYear()+"-"+(t.getMonth()+1>9?t.getMonth()+1:"0"+(t.getMonth()+1))+"-"+(t.getDate()>9?t.getDate():"0"+t.getDate())+" "+(t.getHours()>9?t.getHours():"0"+t.getHours())+":"+(t.getMinutes()>9?t.getMinutes():"0"+t.getMinutes())+":"+(t.getSeconds()>9?t.getSeconds():"0"+t.getSeconds()):""}},mounted:function(){this.getRoleList(),console.log("刷新表格页面,参数",this.params)},resume:function(){console.log("表格页面resume")},pause:function(){console.log("表格页面pause")}}}).call(this,o("24aa"))},e9d3:function(e,t,o){"use strict";o.r(t);var i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("section",[o("el-col",{staticClass:"aweb-table-toolbar",staticStyle:{"padding-bottom":"0px"},attrs:{span:24}},[o("el-form",{attrs:{inline:!0,model:e.searchForm,size:"mini"}},[o("el-form-item",{attrs:{label:"角色ID"}},[o("el-input",{model:{value:e.searchForm.roleId,callback:function(t){e.$set(e.searchForm,"roleId",t)},expression:"searchForm.roleId"}})],1),o("el-form-item",{attrs:{label:"角色名"}},[o("el-input",{model:{value:e.searchForm.roleName,callback:function(t){e.$set(e.searchForm,"roleName",t)},expression:"searchForm.roleName"}})],1),o("el-form-item",{attrs:{label:"创建用户"}},[o("el-input",{model:{value:e.searchForm.createUser,callback:function(t){e.$set(e.searchForm,"createUser",t)},expression:"searchForm.createUser"}})],1)],1),o("el-form",{attrs:{size:"mini"}},[o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:e.searchRoleList}},[e._v("查询")]),o("el-button",{attrs:{type:"primary"},on:{click:e.resetForm}},[e._v("重置")]),o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addRoleVisible=!0}}},[e._v("新建")]),o("el-button",{attrs:{type:"primary",disabled:e.isSingle},on:{click:e.showEditRoleModal}},[e._v("修改")]),o("el-button",{attrs:{type:"primary",disabled:e.isDubble},on:{click:e.delRole}},[e._v("删除")]),o("el-button",{attrs:{type:"primary",disabled:e.isSingle},on:{click:e.showLevelModal}},[e._v("关联权限")])],1)],1)],1),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.roleList,"max-height":"500"},on:{"selection-change":e.selectRole}},[o("el-table-column",{attrs:{type:"selection",width:"55"}}),o("el-table-column",{attrs:{type:"index",width:"60"}}),o("el-table-column",{attrs:{prop:"roleId",label:"角色ID",width:"120",sortable:""}}),o("el-table-column",{attrs:{prop:"roleName",label:"角色名",width:"120",sortable:""}}),o("el-table-column",{attrs:{prop:"createUser",label:"创建用户",width:"120",sortable:""}}),o("el-table-column",{attrs:{prop:"createTime",label:"创建时间","min-width":"120",sortable:""}}),o("el-table-column",{attrs:{prop:"updateTime",label:"更新时间","min-width":"120",sortable:""}}),o("el-table-column",{attrs:{prop:"remark",label:"备注","min-width":"180",sortable:""}})],1),o("el-col",{staticClass:"aweb-table-toolbar",attrs:{span:24}},[o("el-pagination",{staticStyle:{float:"right"},attrs:{layout:"prev, pager, next","page-size":e.pageSize,total:e.totalRole},on:{"current-change":e.getPageRole}})],1),o("el-dialog",{attrs:{title:"新增角色",visible:e.addRoleVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.addRoleVisible=t}}},[o("el-form",{ref:"addForm",attrs:{model:e.addForm,"label-width":"80px",rules:e.addFormRules,size:"mini"}},[o("el-form-item",{attrs:{label:"角色名",prop:"name"}},[o("el-input",{attrs:{"auto-complete":"off"},model:{value:e.addForm.name,callback:function(t){e.$set(e.addForm,"name",t)},expression:"addForm.name"}})],1),o("el-form-item",{attrs:{label:"备注",prop:"remark"}},[o("el-input",{attrs:{"auto-complete":"off",type:"textarea"},model:{value:e.addForm.remark,callback:function(t){e.$set(e.addForm,"remark",t)},expression:"addForm.remark"}})],1)],1),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary",loading:e.addLoading},nativeOn:{click:function(t){return e.surAddRole(t)}}},[e._v("确认")]),o("el-button",{nativeOn:{click:function(t){e.addRoleVisible=!1}}},[e._v("取消")])],1)],1),o("el-dialog",{attrs:{title:"编辑角色",visible:e.editRoleVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.editRoleVisible=t}}},[o("el-form",{ref:"editForm",attrs:{model:e.editForm,"label-width":"80px",rules:e.editFormRules,size:"mini"}},[o("el-form-item",{attrs:{label:"角色名",prop:"name"}},[o("el-input",{attrs:{"auto-complete":"off"},model:{value:e.editForm.name,callback:function(t){e.$set(e.editForm,"name",t)},expression:"editForm.name"}})],1),o("el-form-item",{attrs:{label:"备注",prop:"remark"}},[o("el-input",{attrs:{"auto-complete":"off",type:"textarea"},model:{value:e.editForm.remark,callback:function(t){e.$set(e.editForm,"remark",t)},expression:"editForm.remark"}})],1)],1),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary",loading:e.editLoading},nativeOn:{click:function(t){return e.surEditRole(t)}}},[e._v("确认")]),o("el-button",{nativeOn:{click:function(t){e.editRoleVisible=!1}}},[e._v("取消")])],1)],1),o("el-dialog",{attrs:{title:"配置角色",visible:e.levelModalVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.levelModalVisible=t}}},[o("div",{staticClass:"role-tree-wrap"},[o("el-tree",{ref:"roleMenuTree",staticStyle:{"max-height":"500px",overflow:"auto"},attrs:{data:e.roleMenuTree,"show-checkbox":"","default-expand-all":"","node-key":"id","highlight-current":"",props:e.defaultProps,"default-checked-keys":e.checkedMenu},on:{"check-change":e.selectedMenuTree}})],1),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary",loading:e.addLoading},nativeOn:{click:function(t){return e.associateLevel(t)}}},[e._v("确认")]),o("el-button",{nativeOn:{click:function(t){e.levelModalVisible=!1}}},[e._v("取消")])],1)])],1)},r=[],l=o("ddc4"),a=l["a"],s=(o("4fb3"),o("2877")),n=Object(s["a"])(a,i,r,!1,null,null,null);t["default"]=n.exports}}]);