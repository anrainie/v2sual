<!-- 场景监控组件 -->
<template>
	<div class="senceMonitor rowCtn">
	    <div class="select">
	    	<akSelect  :label="msg" :seoptions="selList" col_left="col-md-1" col_right="col-md-2" @getValue="value" :value="selValue"></akSelect>
	    </div>
        <div style="height:120px" class="ak_Card">
	        <akCard width="18%" height="100px" backgroundColor="#EEEEEE" display="none" :content="content[0]" ></akCard>
	        <akCard width="18%" height="100px" backgroundColor="#EEEEEE" :content="content[1]"
	        :icon="request[0].imgPath"></akCard>
	        <akCard width="18%" height="100px" backgroundColor="#EEEEEE"  :content="content[2]" :icon="request[1].imgPath"></akCard>
	        <akCard width="18%" height="100px" backgroundColor="#EEEEEE" display="none" :content="content[3]"></akCard>
	        <akCard width="18%" height="100px" backgroundColor="#EEEEEE" display="none" :content="content[4]"></akCard>
        </div>	
        <!-- 连接数图 -->
		<ak_echarts ref="echarts" myChart="conEchart" :list="list" :type="type" width="1021.55px" :xName="xName" :yName="yName" text="连接数"></ak_echarts>
        <ak_echarts ref="agtime" myChart="agEchart" :type="agType" width="1021.55px" :list="agTime" :xName="xName" yName="平均响应时间(/s)" text="平均响应时间"></ak_echarts>
        <ak_echarts ref="thruput" myChart="thEchart" :type="numType" :list="thNum" width="1021.55px" xName="时间" yName="吞吐量(B)" text="吞吐量"></ak_echarts>
		<!-- <router-view/> -->
	</div>
</template>
<script>
// 导入搜索框
import akSelect from '../akSelect'
// 导入卡片
import akCard from '../akCard'
// 导入echarts图
import ak_echarts from '../ak_echarts'
export default {
	name:'senceMonitor',
	data(){
			return {
				//选择场景
				msg:'选择场景',
				//场景列表
				selList:[
				    {
				    	
				    	value:'001',
				    	label:'场景-1'

				    },
				    {
				    	value:'002',
				    	label:'场景-2'

				    },
				    {
				    	value:'003',
				    	label:'场景-3'

				    },
				    {
				    	value:'004',
				    	label:'场景-4'

				    }
				],
				// 选中的值赋给给属性
				selValue:'001',
				// akCard的内容
				content:[
				        {
							label:'场景TPS(/s)',
						    desc:'1000'
					    },
					     {
							label:'成功请求',
						    desc:'500'
					    },
					     {
							label:'失败请求',
						    desc:'100'
					    },
					     {
							label:'活跃连接数',

						    desc:0
					    },
					     {
							label:'新建连接数',
						    desc:0
					    }
				],
				// 成功与失败请求数
				request:[
				    {
					"imgPath": require("../../assets/success.png"),
				    },
				    {
					"imgPath": require("../../assets/fail.png"),
				    },


				],
				

				time:'',
				// 图例种类
				type:['新建连接数','活跃连接数'],
				// x轴数据
				// dataList:[],
				// y轴数据
				list:{},
				// x轴坐标名称
				xName:"时间",
				// y轴坐标名称
				yName:"连接数(个)",
				// 平均响应时间类型
				agType:['平均响应时间'],
				//平均响应时间数据
				agTime:{},
				// 吞吐量折线类型
				numType:["in","out"],
				// 初始吞吐量数据
				thNum:{},
				

			}
		},
	components:{
		ak_echarts,
		akSelect,
		akCard
	},
	methods:{
		//随机数函数
          randomNum(min,max){
              return Math.round(Math.random()*(max-min)+min);
          },
          value(val){
              this.selValue = val;
              // console.log(this.selValue);
          }
	},
	created(){
		    // console.log(this.selValue);
		    if(this.selValue=="001"){
			   this.list = {
				  	id:'001',
				  	x:['1:01','1:02','1:03','1:04','1:05','1:06','1:07','1:08','1:09','1:10','1:11','1:12','1:13','1:14','1:15','1:16','1:17','1:18','1:19','1:20','1:21','1:22','1:23','1:24','1:25','1:26','1:27','1:28','1:30','1:31','1:32','1:33','1:34','1:35','1:36','1:37','1:38','1:39','1:40','1:41','1:42','1:43','1:44','1:45','1:46','1:47','4:00','5:00','6:00','7:00','8:00','9:00','10:00','11:00','12:00','13:00','14:00','15:00','16:00','17:00','18:00','19:00','20:00','21:00','22:00','23:00','24:00','24:01','24:02','24:03','24:04','24:05','24:06','24:07','24:08','24:09','24:10','24:11','24:12','24:13','24:14','24:15','24:16','24:17','24:18','24:19','24:20'],
				  	y:[
				  	    [223,354,156,90,589,78,399,789,100,200,364,56,78,98,150,200,23,43,56,67,89,589,78,399,789,100,200,364,56,78,98,150,200,23,200,364,56,78,98,150,200,23,43,56,67,89,589,223,354,156,90,589,78,399,789,100,200,364,56,78,98,150,200,23,43,56,67,89,589,78,399,789,100,200,364,56,78,98,150,200,23,200,364,56],
				  	    
				  	    [223,354,156,90,589,78,399,789,100,200,364,56,78,98,150,200,23,43,56,67,89,589,78,399,789,100,200,364,56,78,98,150,200,23,200,364,56,78,98,150,200,23,43,56,67,89,589,223,354,156,90,589,78,399,789,100,200,364,56,78,98,150,200,23,43,56,67,89,589,78,399,789,100,200,364,56,78,98,150,200,23,200,364,56]
				  	]
				  	   
				  };
				this.agTime = {
						x:['1:01','1:02','1:03','1:04','1:05','1:06','1:07','1:08','1:09','1:10','1:11','1:12','1:13','1:14','1:15','1:16','1:17','1:18','1:19','1:20','1:21','1:22','1:23','1:24','1:25','1:26','1:27','1:28','1:30','1:31','1:32','1:33','1:34','1:35','1:36','1:37','1:38','1:39','1:40','1:41','1:42','1:43','1:44','1:45','1:46','1:47','4:00','5:00','6:00','7:00','8:00','9:00','10:00','11:00','12:00','13:00','14:00','15:00','16:00','17:00','18:00','19:00','20:00','21:00','22:00','23:00','24:00','24:01','24:02','24:03','24:04','24:05','24:06','24:07','24:08','24:09','24:10','24:11','24:12','24:13','24:14','24:15','24:16','24:17','24:18','24:19','24:20'],
						y:[
				  	       [223,354,156,90,589,78,399,789,100,200,364,56,78,98,150,200,23,43,56,67,89,589,78,399,789,100,200,364,56,78,98,150,200,23,200,364,56,78,98,150,200,23,43,56,67,89,589,223,354,156,90,589,78,399,789,100,200,364,56,78,98,150,200,23,43,56,67,89,589,78,399,789,100,200,364,56,78,98,150,200,23,200,364,56]
				  	      ]

				},
				this.thNum = {
					  	id:'001',
					  	x:['1:01','1:02','1:03','1:04','1:05','1:06','1:07','1:08','1:09','1:10','1:11','1:12','1:13','1:14','1:15','1:16','1:17','1:18','1:19','1:20','1:21','1:22','1:23','1:24','1:25','1:26','1:27','1:28','1:30','1:31','1:32','1:33','1:34','1:35','1:36','1:37','1:38','1:39','1:40','1:41','1:42','1:43','1:44','1:45','1:46','1:47','4:00','5:00','6:00','7:00','8:00','9:00','10:00','11:00','12:00','13:00','14:00','15:00','16:00','17:00','18:00','19:00','20:00','21:00','22:00','23:00','24:00','24:01','24:02','24:03','24:04','24:05','24:06','24:07','24:08','24:09','24:10','24:11','24:12','24:13','24:14','24:15','24:16','24:17','24:18','24:19','24:20'],
					  	y:[
					  	    [223,354,156,90,589,78,399,789,100,200,364,56,78,98,150,200,23,43,56,67,89,589,78,399,789,100,200,364,56,78,98,150,200,23,200,364,56,78,98,150,200,23,43,56,67,89,589,223,354,156,90,589,78,399,789,100,200,364,56,78,98,150,200,23,43,56,67,89,589,78,399,789,100,200,364,56,78,98,150,200,23,200,364,56],
					  	    
					  	    [223,354,156,90,589,78,399,789,100,200,364,56,78,98,150,200,23,43,56,67,89,589,78,399,789,100,200,364,56,78,98,150,200,23,200,364,56,78,98,150,200,23,43,56,67,89,589,223,354,156,90,589,78,399,789,100,200,364,56,78,98,150,200,23,43,56,67,89,589,78,399,789,100,200,364,56,78,98,150,200,23,200,364,56]
					  	]
				  	   
				  }
				}
			},
		activated(){
			     if(this.selValue){
			     var _this=this,getFun=this.$refs.echarts.setValue
				  this.time=setInterval(function(){
					var data = [     
				                   {
		                            name:"活跃连接数",
		                            x:'10:10',
		                            y:_this.randomNum(0,1000)
		                           },
		                           {
		                            name:"新建连接数",
		                            x:'10:10',
		                            y:_this.randomNum(0,1000)
		                           }
		                    ]
		             _this.content[3].desc = data[0].y;
		             _this.content[4].desc = data[1].y;
					 getFun(data)
				  },3000);	
		    }
				  
		    
	},	
	watch:{
		// 场景切换
		selValue(val){
			clearInterval(this.time);
			console.log(val);
			var empty = this.$refs.echarts.emptyValue;
			empty();
			//将akCard中新建和活跃数值置为空
			this.content[3].desc = 0;
			this.content[4].desc = 0;
			if(val=="001"){
			   this.list = {
				  	id:'001',
				  	x:['00:00','1:01','1:02','1:03','1:04','1:05','1:06','1:07','1:08','1:09','1:10','1:11','1:12','1:13','1:14','1:15','1:16','1:17','1:18','1:19','1:20','1:21','1:22','1:23','1:24','1:25','1:26','1:27','1:28','1:30','1:31','1:32','1:33','1:34','1:35','1:36','1:37','1:38','1:39','1:40','1:41','1:42','1:43','1:44','1:45','1:46','1:47','4:00','5:00','6:00','7:00','8:00','9:00','10:00','11:00','12:00','13:00','14:00','15:00','16:00','17:00','18:00','19:00','20:00','21:00','22:00','23:00','24:00','24:01','24:02','24:03','24:04','24:05','24:06','24:07','24:08','24:09','24:10','24:11','24:12','24:13','24:14','24:15','24:16','24:17','24:18','24:19','24:20'],
				  	y:[
				  	    [223,354,156,90,589,78,399,789,100,200,364,56,78,98,150,200,23,43,56,67,89,589,78,399,789,100,200,364,56,78,98,150,200,23,200,364,56,78,98,150,200,23,43,56,67,89,589,223,354,156,90,589,78,399,789,100,200,364,56,78,98,150,200,23,43,56,67,89,589,78,399,789,100,200,364,56,78,98,150,200,23,200,364,56],
				  	    
				  	    [223,354,156,90,589,78,399,789,100,200,364,56,78,98,150,200,23,43,56,67,89,589,78,399,789,100,200,364,56,78,98,150,200,23,200,364,56,78,98,150,200,23,43,56,67,89,589,223,354,156,90,589,78,399,789,100,200,364,56,78,98,150,200,23,43,56,67,89,589,78,399,789,100,200,364,56,78,98,150,200,23,200,364,56]
				  	]
				  	   
				  };
				  var _this=this,getFun=this.$refs.echarts.setValue
				  this.time=setInterval(function(){
					var data = [     
				                   {
		                            name:"活跃连接数",
		                            x:'10:10',
		                            y:_this.randomNum(0,1000)
		                           },
		                           {
		                            name:"新建连接数",
		                            x:'10:10',
		                            y:_this.randomNum(0,1000)
		                           }
		                    ]
		            _this.content[3].desc = data[0].y;
		            // console.log(_this.content[3].desc);
		            _this.content[4].desc = data[1].y;
					getFun(data)
				  },3000);	
				}
			if(val=="002"){
			   this.list = {
				  	id:'002',
				  	x:['00:00','1:01','1:02','1:03','1:04','1:05','1:06','1:07','1:08','1:09','1:10','1:11','1:12','1:13','1:14','1:15','1:16','1:17','1:18','1:19','1:20','1:21','1:22','1:23','1:24','1:25','1:26','1:27','1:28','1:30','1:31','1:32','1:33','1:34','1:35','1:36','1:37','1:38','1:39','1:40','1:41','1:42','1:43','1:44','1:45','1:46','1:47','4:00','5:00','6:00','7:00','8:00','9:00','10:00','11:00','12:00','13:00','14:00','15:00','16:00','17:00','18:00','19:00','20:00','21:00','22:00','23:00','24:00','24:01','24:02','24:03','24:04','24:05','24:06','24:07','24:08','24:09','24:10','24:11','24:12','24:13','24:14','24:15','24:16','24:17','24:18','24:19','24:20'],
				  	y:[
				  	    [223,354,156,90,589,78,399,789,100,200,364,56,78,98,150,200,23,43,56,67,89,589,78,399,789,100,200,364,56,78,98,150,200,23,200,364,56,78,98,150,200,23,43,56,67,89,589,223,354,156,90,589,78,399,789,100,200,364,56,78,98,150,200,23,43,56,67,89,589,78,399,789,100,200,364,56,78,98,150,200,23,200,364,56],
				  	    
				  	    [223,354,156,90,589,78,399,789,100,200,364,56,78,98,150,200,23,43,56,67,89,589,78,399,789,100,200,364,56,78,98,150,200,23,200,364,56,78,98,150,200,23,43,56,67,89,589,223,354,156,90,589,78,399,789,100,200,364,56,78,98,150,200,23,43,56,67,89,589,78,399,789,100,200,364,56,78,98,150,200,23,200,364,56]
				  	]
				  	   
				  };
				  var _this=this,getFun=this.$refs.echarts.setValue
				  this.time=setInterval(function(){
					var data = [     
				                   {
		                            name:"活跃连接数",
		                            x:'10:10',
		                            y:_this.randomNum(0,1000)
		                           },
		                           {
		                            name:"新建连接数",
		                            x:'10:10',
		                            y:_this.randomNum(0,1000)
		                           }
		                    ]
		            _this.content[3].desc = data[0].y;
		            // console.log(_this.content[3].desc);
		            _this.content[4].desc = data[1].y;
					getFun(data)
				  },3000);	
				}
			   if(val=="003"){
			   this.list = {
				  	id:'003',
				  	x:['00:00','1:01','1:02','1:03','1:04','1:05','1:06','1:07','1:08','1:09','1:10','1:11','1:12','1:13','1:14','1:15','1:16','1:17','1:18','1:19','1:20','1:21','1:22','1:23','1:24','1:25','1:26','1:27','1:28','1:30','1:31','1:32','1:33','1:34','1:35','1:36','1:37','1:38','1:39','1:40','1:41','1:42','1:43','1:44','1:45','1:46','1:47','4:00','5:00','6:00','7:00','8:00','9:00','10:00','11:00','12:00','13:00','14:00','15:00','16:00','17:00','18:00','19:00','20:00','21:00','22:00','23:00','24:00','24:01','24:02','24:03','24:04','24:05','24:06','24:07','24:08','24:09','24:10','24:11','24:12','24:13','24:14','24:15','24:16','24:17','24:18','24:19','24:20'],
				  	y:[
				  	    [223,354,156,90,589,78,399,789,100,200,364,56,78,98,150,200,23,43,56,67,89,589,78,399,789,100,200,364,56,78,98,150,200,23,200,364,56,78,98,150,200,23,43,56,67,89,589,223,354,156,90,589,78,399,789,100,200,364,56,78,98,150,200,23,43,56,67,89,589,78,399,789,100,200,364,56,78,98,150,200,23,200,364,56],
				  	    
				  	    [223,354,156,90,589,78,399,789,100,200,364,56,78,98,150,200,23,43,56,67,89,589,78,399,789,100,200,364,56,78,98,150,200,23,200,364,56,78,98,150,200,23,43,56,67,89,589,223,354,156,90,589,78,399,789,100,200,364,56,78,98,150,200,23,43,56,67,89,589,78,399,789,100,200,364,56,78,98,150,200,23,200,364,56]
				  	]
				  	   
				  };
				  var _this=this,getFun=this.$refs.echarts.setValue
				  this.time=setInterval(function(){
					var data = [     
				                   {
		                            name:"活跃连接数",
		                            x:'10:10',
		                            y:_this.randomNum(0,1000)
		                           },
		                           {
		                            name:"新建连接数",
		                            x:'10:10',
		                            y:_this.randomNum(0,1000)
		                           }
		                    ]
		            _this.content[3].desc = data[0].y;
		            // console.log(_this.content[3].desc);
		            _this.content[4].desc = data[1].y;
					getFun(data)
				  },3000);	
				}

		}
	},	
	// 销毁定时器
	beforeRouteLeave(to,from,next){
         clearInterval(this.time);
         next();
    },
 

}
</script>
<style scoped>
	.ak_Card{
		height:120px;
		padding:10px 0;
	}
	.select{
		padding-left:15px;
	}
</style>

